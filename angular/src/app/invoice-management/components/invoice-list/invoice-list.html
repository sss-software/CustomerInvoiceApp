<div class="card">
  <!-- Card Header -->
  <div class="card-header d-flex justify-content-between align-items-center">
    <!-- Left: Title -->
    <h4 class="mb-0">Invoice Management</h4>

    <!-- Middle: Search box -->
    <div class="flex-grow-1 d-flex justify-content-center">
      <div class="input-group" style="width: 400px; max-width: 80%;">
        <input
          type="text"
          class="form-control"
          placeholder="Search..."
          [(ngModel)]="searchTerm"
          (keyup.enter)="search()"
        />
        <!-- Search Button: only visible when input is empty -->
        <button
          type="button"
          title="Search"
          class="btn btn-outline-secondary"
          *ngIf="!searchTerm || searchTerm.trim() === ''"
          (click)="search()"
        >
          <i class="fas fa-search"></i>
        </button>

        <!-- Clear Button: only visible when input has text -->
        <button
          type="button"
          title="Clear current search"
          class="btn btn-outline-secondary"
          *ngIf="searchTerm && searchTerm.trim() !== ''"
          (click)="clearSearch()"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>

    <!-- Right: Create Invoice Button -->
    <div>
      <button
        type="button"
        title="Create a new invoice"
        class="btn btn-primary"
        (click)="create()"
      >
        <i class="fas fa-plus me-1"></i>
        Create Invoice
      </button>
    </div>
  </div>

  <!-- Card Body / Table -->
  <div class="card-body p-0">
    <table class="table table-hover mb-0">
      <thead class="table-light">
        <tr>
          <th (click)="changeSorting('Number')" style="cursor:pointer">
            Number
            <i
              *ngIf="sortingField === 'Number'"
              class="fas"
              [ngClass]="sortingDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"
            ></i>
          </th>
          <th (click)="changeSorting('InvoiceDate')" style="cursor:pointer">
            Date
            <i
              *ngIf="sortingField === 'InvoiceDate'"
              class="fas"
              [ngClass]="sortingDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"
            ></i>
          </th>
          <th (click)="changeSorting('CustomerName')" style="cursor:pointer">
            Customer
            <i
              *ngIf="sortingField === 'CustomerName'"
              class="fas"
              [ngClass]="sortingDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"
            ></i>
          </th>
          <th class="text-end">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let invoice of invoices"
          [class.selected-row]="invoice.id === selectedInvoiceId"
          (click)="selectInvoice(invoice.id)"
        >
          <td>{{ invoice.number }}</td>
          <td>{{ invoice.invoiceDate | date: 'shortDate' }}</td>
          <td>{{ invoice.customerName }}</td>
          <td class="text-end">
            <button
              type="button"
              title="View Invoice Details"
              class="btn btn-sm btn-outline-primary me-1"
              (click)="view(invoice.id)"
            >
              <i class="fas fa-eye"></i>
            </button>
            <button
              type="button"
              title="Edit Invoice"
              class="btn btn-sm btn-outline-secondary me-1"
              (click)="edit(invoice.id)"
            >
              <i class="fas fa-edit"></i>
            </button>
            <button
              type="button"
              title="Delete Invoice"
              class="btn btn-sm btn-outline-danger"
              (click)="delete(invoice)"
            >
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Card Footer / Pagination -->
  <div class="card-footer d-flex justify-content-center align-items-center py-3">
    <div>
      Showing {{ startItem }} – {{ endItem }} of {{ totalCount }}
    </div>
    <div class="mx-4"></div>
    <div class="d-flex align-items-center">
      <button
        type="button"
        class="btn btn-sm btn-outline-secondary me-2"
        [disabled]="page === 1"
        (click)="changePage(page - 1)"
      >
        ‹ Prev
      </button>
      <span>Page {{ page }} of {{ totalPages }}</span>
      <button
        type="button"
        class="btn btn-sm btn-outline-secondary ms-2"
        [disabled]="page >= totalPages"
        (click)="changePage(page + 1)"
      >
        Next ›
      </button>
    </div>
  </div>
</div>
